<!DOCTYPE html>
<html lang="en">
<head>
<title>PMLTQ test page</title>
<style type="text/css" media="screen">
    #editor { 
        position: absolute;
        top: 0;
        right: 0;
        bottom: 0;
        left: 0;
    }
</style>
</head>
<body>
<script>if(window.location.protocol != "http:")alert("It is needed to ron this file using http server!\nWrite to commandline:\ncd "+window.location.pathname.split("/").slice(0, -1).join("/")+"\nhttp-server\n\nAnd go to address: localhost:8080/test.html ");</script>
<div id="editor"></div>
    

<script src="lib/requirejs/require.js" type="text/javascript" charset="utf-8"></script>

<script>
    // Tell RequireJS where ace is located
    require.config({
        paths: {
            'ace': 'lib/ace'
        }
    });

    // Load the ace module
    require(['ace/ace',"ace/mode/pmltq"], function(ace) {
        // Set up the editor
        var editor = ace.edit('editor');
        editor.setTheme('ace/theme/pmltq');

/************* Setting mode ***********/
        var PmltqMode = require("ace/mode/pmltq").Mode;
        var PMLTQMode = new PmltqMode();
        editor.session.setMode(PMLTQMode);
        var tags = ["child", "descendant"];
        PMLTQMode.$highlightRules.setKeywords({"relation": tags.join("|")});
        editor.session.bgTokenizer.start(0);


/************* Testing event ***********/
        editor.on('input', function() {
            var pos = editor.session.getSelection().getCursor();
            //alert(editor.session.getTokenAt(pos.row,pos.column));
            console.log(editor.session.getTokenAt(pos.row,pos.column));
            console.log(editor.session.getTokens(pos.row));
        });

/************* Loading document ***********/
        var client = new XMLHttpRequest();
        client.open('GET', '../../demo/kitchen-sink/docs/pmltq.pmltq');
        client.onreadystatechange = function() {
          editor.setValue(client.responseText,1);
        };
        client.send();
    });


</script>



</body>
</html>
